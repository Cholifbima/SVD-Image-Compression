<!doctype html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="{{ url_for('static', filename='css/output.css') }}" rel="stylesheet">
    <title>Hasil Kompresi</title>
</head>

<body class="flex flex-col min-h-screen w-full">
    <header class="bg-biru-muda">
            <div class="grid grid-cols-1 md:grid-cols-[1fr_2fr_1fr] items-center py-7">
                <div class="hidden md:flex justify-start pl-24">
                    <img src="{{ url_for('static', filename='img/logo-uns.png') }}" alt="logo-uns" class="h-14 w-auto" />
                </div>

                <div class="text-center">
                    <h1 class="flex justify-center items-center text-xl sm:text-2xl md:text-3xl lg:text-5xl text-biru-tua-banget font-bold">
                        Image Compression
                    </h1>
                </div>

                <div class="hidden md:block"></div>
            </div>

            <div class="h-1 bg-biru-tua-banget mx-3 md:mx-6 lg:mx-12"></div>
        </header>

    <main class="flex-1 text-base sm:text-lg md:text-xl lg:text-2xl bg-biru-muda py-12 flex flex-col items-center gap-8 px-12">
        <h2 class="text-lg sm:text-xl md:text-2xl lg:text-3xl font-bold text-biru-tua-banget">Hasil Kompresi</h2>
        
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
            <div class="text-center">
                <h3 class="font-semibold mb-2">Gambar Asli</h3>
                <div class="border-3 border-biru rounded-3xl w-full flex-1 flex flex-col gap-4 justify-center items-center relative  overflow-hidden object-contain">
                    <img src="{{ url_for('preview', fname=before_fname) }}" alt="sebelum" class="shadow-lg">
                </div>
            </div>
            <div class="text-center">
                <h3 class="font-semibold mb-2">Gambar Terkompresi</h3>
                <div class="border-3 border-biru rounded-3xl w-full flex-1 flex flex-col gap-4 justify-center items-center relative  overflow-hidden object-contain">
                    <img id="compressedImg" src="{{ url_for('preview', fname=after_fname) }}" alt="sesudah" class="shadow-lg">
                </div>
            </div>
        </div>
        
        <div class="w-4/5 md:w-1/2 mt-6 flex flex-col items-center gap-2">
            <label for="kSlider" class="text-lg font-semibold">Sesuaikan nilai k: <span id="kVal">{{ k }}</span></label>
            <input type="range" id="kSlider" min="1" max="400" value="{{ k }}" class="w-full h-2 rounded-lg accent-blue-600">
        </div>

        <div id="stats" class="bg-white border-4 border-biru rounded-4xl p-6 w-11/12 sm:w-3/4 md:w-1/2 text-base leading-relaxed mt-4">
            <h4 class="font-bold mb-3">Compression Result Details</h4>
            <hr class="my-4">
            <p><strong>Image pixel size:</strong> {{ dimension }}</p>
            <!--
            <p><strong>Pixels:</strong> {{ total_pixels }}</p>
            <p><strong>Uncompressed matrix size:</strong> {{ uncompressed_matrix_size }} (proportional to pixels)</p>
            <p><strong>Compressed matrix size:</strong> {{ compressed_matrix_size }} ({{ height }}Ã—{{ k }} + {{ k }} + {{ k }}Ã—{{ width }}) Ã— 3</p>
            <p><strong>SVD compression ratio:</strong> {{ svd_compression_ratio }}</p>
            -->
            
            <!--
            <h4 class="font-bold text-lg mb-3">File Size Metrics (Secondary)</h4>
            -->
            <p><strong>Original file size:</strong> {{ before_size_kb }} KB</p>
            <p><strong>Compressed file size:</strong> {{ after_size_kb }} KB</p>
            <p><strong>File compression ratio:</strong> {{ ratio }}</p>
            <!--
            <p><strong>Info preserved:</strong> <span id="infoPreserved">{{ info_preserved }}%</span></p>
            -->

            <hr class="my-4">
            <div class="bg-blue-50 p-3 rounded text-sm">
                <p class="font-semibold text-blue-800">ðŸ’¡ Important Note:</p>
                <p class="text-blue-700">The SVD compression ratio reflects the mathematical compression of the matrix. The file size is adjusted based on the remaining information (lower k = lower JPEG quality due to loss of detail from SVD).</p>
            </div>
            
            <hr class="my-4">
            <p><strong>k value:</strong> {{ k }}</p>
            <p><strong>Runtime:</strong> {{ runtime }} seconds</p>
            <p><strong>Level:</strong> {{ preset }}</p>
        </div>

        <a id="downloadBtn" href="{{ url_for('download', fname=after_fname) }}" class="bg-biru-tua text-white rounded-full px-10 py-3 mt-4">Download Hasil</a>
        
    </main>

    <footer>
        <div class="w-full bg-biru-tua text-white text-center py-4">&copy; 2025, Cholif Bima A - Lutfiyah Istiana - Shafa Rifkika NF</div>
    </footer>

    <script src="{{ url_for('static', filename='js/result-page.js') }}"></script>
</body>
</html>